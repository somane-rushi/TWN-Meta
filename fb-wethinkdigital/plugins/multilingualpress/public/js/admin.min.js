;var MultilingualPress=window.MultilingualPress||{};var MultilingualPressRedirectorSettings=window.MultilingualPressRedirectorSettings||{};MultilingualPress.RedirectorSettings=MultilingualPressRedirectorSettings;delete window.MultilingualPressRedirectorSettings;(function(t,e,n){'use strict';e.LanguageSearch=function(e){var u=!1,o,a,r,i,l,s={};var c=function(i,a){t.ajax({url:n,method:'POST',dataType:'json',data:{action:e.data('action'),search:i}}).done(function(e){if(e.success&&e.data&&t.isArray(e.data)){s[i]=e.data;return a(e.data)};return[]}).fail(function(){return a([])})};this.init=function(){if(!u){o=e.closest('td');a=t(e.data('connected'));r=o.find('.current-selection');i=o.find('.remove-selection');l=e.data('none');e.autocomplete({minLength:2,select:function(e,n){r&&r.text(n.item.label);a&&a.val(n.item.value);i&&i.show();t(this).val('');return!1},source:function(t,e){if(t.term in s){e(s[t.term]);return};c(t.term,e)}});i.click(function(t){t.preventDefault();r.text(l);a.val('');e.val('');i.hide()});u=!0};return this}}}(jQuery,MultilingualPress,ajaxurl));(function(t,e,n){'use strict';e.NavMenu=function(e,i,a){var u=!1,r,l,c,f=function(t){c.css('visibility',t?'visible':'hidden')},d=function(){var e=[];r.filter(':checked').each(function(){e.push(Number(t(this).val()||0))});return e},o=function(){e.prop('disabled',!(i.length&&d().length))},s=function(){alert('AJAX error.')},p=function(t){if(!t.length){s();return};i.append(t)},h=function(t){var i=e.data('nonce-action'),r=e.data('nonce'),o=e.data('action'),n={action:o,mlp_sites:t,menu:a.val(),};n[i]=r;return n},m=function(i){f(!0);e.prop('disabled',!0);r.prop('disabled',!0);t.ajax({url:n,method:'POST',dataType:'json',data:h(i)}).done(function(e){if(e.success&&e.data&&typeof e.data==='string'){p(t(e.data));return};s()}).fail(function(){s()}).always(function(){f(!1);r.prop('checked',!1);r.prop('disabled',!1);e.prop('disabled',!0)})};this.init=function(){if(!u){r=t(e.data('languages'));l=t(e.data('select-all'));c=e.siblings('.spinner');r.click(function(){o()});l.click(function(t){t.preventDefault();r.prop('checked',!0);o()});e.click(function(){var t=d();if(t&&i.length){m(t)}});o();u=!0};return this}}}(jQuery,MultilingualPress,ajaxurl));(function(t,e){'use strict';e.NewSiteLanguage=function(e,n){var i=!1,a=function(t){var e=n.find('option[data-locale="'+t+'"]');if(e.length){return e.attr('value')};return null},r=function(t){var e=n.find('option[data-iso="'+t+'"]');if(e.length){return e.attr('value')};return null},o=function(t){var e=t.split('_'),i;while(e.length){e.pop();i=n.find('option[data-locale="'+e.join('_')+'"]');if(i.length){return i.attr('value')}};return null},s=function(){var e=t(this).val(),i,s,u;i=a(e);if(i){n.val(i);return};s=r(e);if(s){n.val(s);return};u=o(e);if(u){n.val(u)}};this.init=function(){if(!i){e.change(s);i=!0};return this}}}(jQuery,MultilingualPress));(function(t,e){'use strict';e.PostTranslationContext=function(t){var n=!1,e={};this.init=function(){if(!n){e.source_site_id=t.data('source-site');e.source_post_id=t.data('source-post');e.remote_site_id=t.data('remote-site');e.remote_post_id=t.data('remote-post');e.post_type=t.data('post-type');n=!0};return this};this.sourceSiteId=function(){return Number(e.source_site_id||0)};this.sourcePostId=function(){return Number(e.source_post_id||0)};this.remoteSiteId=function(){return Number(e.remote_site_id||0)};this.remotePostId=function(){return Number(e.remote_post_id||0)};this.postType=function(){return String(e.post_type||'')}}}(jQuery,MultilingualPress));(function(t,e){'use strict';e.PostTranslationTaxonomies=function(e,n){var i=!1;this.init=function(){if(!i){i=!0;if(n.length){e.change(function(){n.toggle(!t(this).is(':checked'))})}};return this}}}(jQuery,MultilingualPress));(function(t,e){'use strict';e.SitesRelationshipBulkSelection=function(){var e=!1,n=function(e){e.preventDefault();e.stopImmediatePropagation();var n=t('.mlp-relationships-languages');if(!n.length){return};n.find('input[type="checkbox"]').each(function(n,i){i.checked=(t(e.currentTarget).data('action')==='select')})};this.init=function(){if(!e){t('.mlp-site-bulk-relations').on('click',n);e=!0};return this}}}(jQuery,MultilingualPress));(function(t,e){'use strict';e.TermTranslationContext=function(t){var n=!1,e={};this.init=function(){if(!n){e.source_site_id=t.data('source-site');e.source_term_id=t.data('source-term');e.remote_site_id=t.data('remote-site');e.remote_term_id=t.data('remote-term');e.taxonomy=t.data('taxonomy');n=!0};return this};this.sourceSiteId=function(){return Number(e.source_site_id||0)};this.sourceTermId=function(){return Number(e.source_term_id||0)};this.remoteSiteId=function(){return Number(e.remote_site_id||0)};this.remoteTermId=function(){return Number(e.remote_term_id||0)};this.taxonomy=function(){return String(e.taxonomy||'')}}}(jQuery,MultilingualPress));(function(t,e){'use strict';e.TranslationBoxFactory={createContext:function(t,n){if(t==='term'){return new e.TermTranslationContext(n)};return new e.PostTranslationContext(n)},create:function(t,n){var i=n.find('.tab-relation'),l=i.find('.search-input-row'),o=i.find('.update-relationship'),c=i.find('.main-row input'),a=e.TranslationBoxFactory.createContext(t,n),s=new e.TraslationBoxTabs(n),r=new e.TranslationSearch(t,a,l,o),f=new e.TranslationRelationshipUpdater(t,r,a,n),d=new e.TranslationRelationship(f,s,r,c,o),u;a.init();s.init();r.init();d.init();if(t==='post'){u=new e.PostTranslationTaxonomies(n.find('.mlp-taxonomy-sync input'),n.find('.mlp-taxonomy-box'));u.init()}}}}(jQuery,MultilingualPress));(function(t,e,n){'use strict';e.TranslationRelationship=function(e,i,a,r,o){var d=!1,u,l,v=['existing','new'],p=function(){var t;if(!u){t=i.findInPanel('relation','input, select, textarea');u=i.findInAllPanels('input, select, textarea').not(t)};return u},c=function(){return r.filter(':checked').val()},s=function(t){var e=t||c();a.hideResults();if(e==='new'||e==='leave'){p().attr('disabled',!1);i.enable();o.hide().attr('disabled',!0);a.showField(!1);return};if(e==='nothing'){o.hide().attr('disabled',!0)};a.showField(e==='existing');i.activate('relation');i.disable();p().attr('disabled',!0);if(e==='existing'||e==='remove'){o.attr('disabled',e==='existing').show()}},f=function(e){if(!l){l=t('<span class="spinner" style="float: none; margin: 0 10px 5px;"></span>').appendTo(o.parent())};l.css('visibility',e?'visible':'hidden')},h=function(t,e){r.attr('disabled',!0);o.attr('disabled',!0);a.hideResults();a.showField(!1);f(!0)},m=function(t,e){s();r.attr('disabled',!1);f(!1)},g=function(t,e,n){s();r=n.find('.tab-relation').find('.main-row input');f(!1);b(t,n)},b=function(e,n){var s,u,i,l,r,o=n.parents('.postbox');if(!o.length){return};r=o.find('.mlp-translation-metabox');if(!r.length){return};i=o.find('h2 span');l=o.find('.mlp-entity-edit-link');l.remove();var a=i.html();a=a.replace(/\s-\s$/,'');i.html(a);if(v.indexOf(e)===-1){return};s=r.data('remote-link');u=r.data('remote-link-label');if(!s||!u){return};a+=' - ';i.html(a);i.length&&i.append(t('<a class="mlp-entity-edit-link" href="'+s+'">'+u+'</a>'))},w=function(){var t=window.location.href;return-1!==t.indexOf('&classic-editor')},x=function(){if(typeof wp.data==='undefined'){return};var n=wp.data.select('core/edit-post');if(typeof n==='undefined'){return};var t=!1;wp.data.subscribe(function(){if(w()){return};var i=n.isSavingMetaBoxes();if(i!==t&&!i){t=i;e.updateRelation(c(),h,g,m)};t=i})};this.init=function(){if(!d){r.on('change',function(){s(t(this).val())});o.on('click',function(t){t.preventDefault();e.updateRelation(c(),h,g,m)});if(['post-php','post-new-php'].indexOf(n)!==-1){x()};s();d=!0};return this}}}(jQuery,MultilingualPress,adminpage));(function(t,e,n){'use strict';e.TranslationRelationshipUpdater=function(i,a,r,o){var s=function(t,e){var n={task:t,source_site_id:r.sourceSiteId(),remote_site_id:r.remoteSiteId(),};if(i==='term'){if(!e){e=r.remoteTermId()};n.source_term_id=r.sourceTermId();n.remote_term_id=e;n.action='multilingualpress_update_term_relationship';return n};if(!e){e=r.remotePostId()};n.source_post_id=r.sourcePostId();n.remote_post_id=e;n.action='multilingualpress_update_post_relationship';return n},u=function(n){var r,a;if(!n.success||!n.data||typeof n.data!=='string'){return null};a=t(n.data);if(!a.length){return null};r=o.parent();r.find('.mlp-warning').remove();o.remove();a.appendTo(r);e.TranslationBoxFactory.create(i,a);return a},l=function(t){var e,n,i=['existing','remove','new'];if(-1===i.indexOf(t)){return null};if(t==='existing'){e=a.selectedResult();if(!e){return null}};n=t==='existing'?e:null;return s(t,n)};this.updateRelation=function(e,i,a,o){var r=l(e);if(!r){return};i(e,r);t.ajax({url:n,method:'POST',dataType:'json',data:r}).done(function(t){var n=u(t);if(!n.length){o(e,r);return};a(e,r,n)}).fail(function(){o(e,r)})}}}(jQuery,MultilingualPress,ajaxurl));(function(t,e,n){'use strict';e.TranslationSearch=function(e,i,a,s){var u=this,r,l,o,m,f,d,p,h=0,c={};var g=function(t){var e,n,i,a;if(typeof t!=='object'||!t){return null};e=t.id||0;n=t.title||'';if(!e||!n){return null};i=m.clone();a=i.find('input');a.val(e);a.attr('aria-label',n);i.find('span').text(n+' (ID: '+e+')');return i},v=function(e){var n=g(e);if(!n){return};n.find('input').on('change',function(){var e=t(this);if(e.is(':checked')){s.attr('disabled',!1);n.closest('table').find('td').removeClass('selected');e.closest('td').addClass('selected')}});n.appendTo(o);h++},b=function(t){h=0;o.empty();s.attr('disabled',!0);if(typeof t!=='object'||!t||!t.map){f.clone().appendTo(o);return};t.map(v);if(h<1){f.clone().appendTo(o)}},w=function(t,e){var n={action:r.data('action'),search:e,source_site_id:i.sourceSiteId(),remote_site_id:i.remoteSiteId(),};if(t==='term'){n.source_term_id=i.sourceTermId();n.remote_term_id=i.remoteTermId();return n};n.source_post_id=i.sourcePostId();n.remote_post_id=i.remotePostId();return n},x=function(i){var a=c[e]||{};if(i in a){u.showResults(a[i]);return};if(!(e in c)){c[e]={}};r.addClass('ui-autocomplete-loading');t.ajax({url:n,method:'POST',dataType:'json',data:w(e,i)}).done(function(t){var n=t.success&&t.data?t.data:!1;if(n){c[e][i]=n};u.showResults(n)}).fail(function(){u.showResults(!1)}).always(function(){r.removeClass('ui-autocomplete-loading')})},y=function(t){var e;if(t.which===13){return};if(p){clearTimeout(p)};e=r.val();if(e===d){return};if(e.length<2){u.hideResults(!1);return};d=e;p=setTimeout(function(){x(e);d=null},300)};this.init=function(){var e,n;if(!r){r=a.find('input');r.val('');r.keyup(y).keydown(function(t){if(t.which===13){t.preventDefault()}});l=t(r.data('results'));o=l.find('table tbody');e=o.find('.search-results-row');n=o.find('.search-results-none');m=e.clone().show();f=n.clone().show();e.remove();n.remove()}};this.showField=function(t){a.toggle(t)};this.showResults=function(t){b(t);l.show()};this.hideResults=function(t){o.empty();l.hide();if(t!==!1){r.val('')}};this.selectedResult=function(){var t=o.find('input:checked').eq(0);if(t.length){return t.val()};return null}}}(jQuery,MultilingualPress,ajaxurl));(function(t,e){'use strict';e.TraslationBoxTabs=function(e){var n,i,a,r,o=function(){if(!n){n=e.find('.wp-tab-panel')};return n},s=function(){if(!i){i=e.find('.nav-tab')};return i};this.init=function(){e.tabs({active:0,activate:function(e,n){a=n.newTab;r=n.newPanel;t(this).trigger('translation-metabox-tab-activated',n)},create:function(e,n){a=n.tab;r=n.panel;t(this).trigger('translation-metabox-tab-created',n)}});return this};this.disable=function(){this.init();e.tabs('disable')};this.enable=function(){this.init();e.tabs('enable')};this.activate=function(n){var i=0;this.init();if(!n){return};s().each(function(){var a=t(this).attr('id').match(/tab-([a-z-]+)$/);if(a[1]===n){e.tabs('option','active',i)};i++})};this.findInPanel=function(t,i){var a;if(!n){n=e.find('.wp-tab-panel')};a=n.find('.tab-'+t);if(!a.length){return a};return a.find(i)};this.findInAllPanels=function(t){return o().find(t)}}}(jQuery,MultilingualPress));(function(t,e,n){'use strict';t(function(){var i,a,r,o;if(n==='post-new-php'||n==='post-php'){t('.mlp-translation-metabox').each(function(){e.TranslationBoxFactory.create('post',t(this))})};if(n==='term-php'){t('.mlp-translation-metabox').each(function(){e.TranslationBoxFactory.create('term',t(this))})};if(n==='site-new-php'){i=new e.NewSiteLanguage(t('#site-language'),t('#mlp-site-language'));i.init()};if(n==='sites_page_multilingualpress-site-settings'){a=new e.LanguageSearch(t('#mlp-site-language'));a.init()};if(n==='site-new-php'||n==='sites_page_multilingualpress-site-settings'){r=new e.SitesRelationshipBulkSelection();r.init()};if(n==='nav-menus-php'){o=new e.NavMenu(t('#mlp-languages-submit'),t('#menu-to-edit'),t('#menu'));o.init()}})}(jQuery,MultilingualPress,adminpage));